<div class="payment-form klarna-installment-form" id="klarnaInstallment">
    <h3>Delbetaling</h3>
    <h3>Konto - Betal i ditt eget tempo</h3>

    <span id="ratexx"></span>

    <script src="https://cdn.klarna.com/public/kitt/core/v1.0/js/klarna.min.js"></script>
    <script src="https://cdn.klarna.com/public/kitt/toc/v1.1/js/klarna.terms.min.js"></script>

    <script>
        new Klarna.Terms.Account({
            el: 'ratexx',
            eid: '{{ form.klarna_installment.vars.attr.EID }}',
            locale: 'nb_no',
            charge: 0,
            type: 'desktop'
        });
    </script>

    {% include '@klarna/errorInstallment.twig' %}

    <div id="paymentForm_klarna_installment">
        {% for key, formRow in form.klarna_installment.children %}
            <div>
                {% if formRow.vars.name == 'installment_pay_index' %}
                    <div id="paymentForm_klarna_installment_installment_pay_index">
                        {% for keyPayIndex, rowPayIndex in formRow.children %}

                            {{ form_widget(rowPayIndex) }}
                            {% for payment in form.klarna_installment.vars.installmentResponseTransfer.payments  if rowPayIndex.vars.value == payment.id %}
                                <table class="paymentDescription">
                                    <tr>
                                        <td>Årsrente</td>
                                        <td>{{ payment.getInterestRate }} %</td>
                                    </tr>
                                    <tr>
                                        <td>Etableringsgebyr</td>
                                        <td>{{ payment.startFee }} kr</td>
                                    </tr>
                                    <tr>
                                        <td>Fakturagebyr</td>
                                        <td>{{ payment.getInvoiceFee }} kr/mån</td>
                                    </tr>
                                    <tr>
                                        <td>Debetal fra</td>
                                        <td>{{ payment.getMonthlyCosts }}</td>
                                    </tr>
                                </table><hr/>
                            {% endfor %}

                        {% endfor %}
                    </div>
                {% else %}
                    {{ form_label(formRow) }}
                    {{ form_widget(formRow) }}
                {% endif %}
            </div>
        {% endfor %}
    </div>

    {#{{ form_widget(form.klarna_installment) }}#}

    <div>
        Eksempel: For et kjøp på 10000 kr, er renten 22% og effectiv rente er 36,12% ved betaling over 12 måneder. Total kredittkjøpspris 11771 kr.
    </div>

</div>
<script>
    var errorMsgDateBirthMandatory = "Fødsel er nødvendig";
    var errorMsgDateBirthWrong = "false fødsel";
    var errorMsgPNOMandatory = "PNO er nødvendig";
    var errorMsgTermsMandatory = "Forhold er nødvendig";
    var errorMsgPaymentTypeMandatory = "Betaling kreves";
</script>
